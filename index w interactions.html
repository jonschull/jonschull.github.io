<html>
<head>
    <script type="text/javascript"  src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <script type="text/javascript"  src="https://cdn.jsdelivr.net/npm/brython@3.9.0/brython.min.js">     </script>
    <script type="text/javascript"  src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.8.8/brython_stdlib.js"></script>

    <style type="text/css">
        #mynetwork {
            width: 100%;
            height: 800px;
        }
        table,td,th{
            border: 1px solid black;
        }
        body {
            margin: 0;            /* Reset default margin */
        }
        iframe {
            display: block;       /* iframes are inline by default */
            background: #000;
            border: none;         /* Reset default border */
            height: 100vh;        /* Viewport-relative units */
            width: 100vw;
        }
    </style>

</head>
<body onload="brython()">
    <script type="text/python">
    from browser import document,html
    from browser.html import *

    errorBox = DIV(PRE(ID='console'))
    document<=errorBox

    import sys
    class MyOutput:
        def __init__(self):
            self.console = document["console"]

        def write(self, text):
            self.console.html +=  text + '</hr>'

    sys.stdout = MyOutput()
    sys.stderr = MyOutput()

    document <= TABLE(  TR( TH('Text')+ TH('Diagram')) +
                        TR( TD('Text goes here!!!') + TR(DIV('goes here', id="mynetwork"))))

    nodes =[dict(id="1.1", label='1'),
            dict(id=2, label='2')]

    edges = [{'from':"1.1", 'to': 2}]


    graphString = """
    ID      1
    LABEL   First item
    URL     This is the hubURL
    TITLE   This is popup text
    it can be multiple lines
    but don't go crazy

    ID      1.1
    LABEL   Second Item
    URL     This is the URL
    TITLE   This is popup text

    ID      1.1.1
    LABEL   This is what shows
    URL     This is the URL
    TITLE   This is popup text

    ID      1.1.2
    LABEL   These two are siblings
    URL     This is the URL
    TITLE   This is popup text
    """

    keywords = 'ID LABEL URL TITLE'.split()

    def getNodes(graphString=graphString):
        items = graphString.strip().split('ID')
        items = [item for item in items if item.strip()]
        nodes=[] #a list of dicts
        for item in items:
            node = dict()
            for i, line in enumerate(item.split('\n')):
                if line.strip():
                    if i == 0: line = 'ID ' + line
                    firstWord = line.split()[0]
                    if firstWord in keywords:
                        node[firstWord] = line.replace(firstWord,'').strip()
            nodes.append(node)
        return(nodes)

    for item in getNodes():
        print(item)

    data = {'nodes':nodes, 'edges': edges}

    options = {"layout":{"hierarchical": {
                                  "enabled": True,
                                  "direction": 'LR',
                                  "sortMethod": "directed",
                                  "nodeSpacing":5,
                                  "treeSpacing":5},
                            },
                    "edges":{"smooth": True,
                             "arrows":{"to":True}
                             },
                     "nodes":{"shape":"box",
                              "font" :"14px"
                             }
                 };

    from browser import window
    container = document['mynetwork']
    network = window.vis.Network.new(container, data, options)

    def networkClick(params):
        print('networkClick', params.nodes)

    network.on("click", networkClick);

    </script>


</body>
</html>
